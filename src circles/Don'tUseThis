This is basicly daniel shiffmans code. If you like this go to him.
